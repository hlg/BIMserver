package org.bimserver.test;

import com.fasterxml.jackson.databind.JsonNode;
import com.fasterxml.jackson.databind.ObjectMapper;
import com.fasterxml.jackson.databind.SerializationFeature;
import org.bimserver.*;
import org.bimserver.client.DirectBimServerClientFactory;
import org.bimserver.client.json.JsonBimServerClientFactory;
import org.bimserver.database.DatabaseRestartRequiredException;
import org.bimserver.database.berkeley.DatabaseInitException;
import org.bimserver.interfaces.objects.SExtendedData;
import org.bimserver.models.log.AccessMethod;
import org.bimserver.models.store.ServerState;
import org.bimserver.plugins.services.BimServerClientInterface;
import org.bimserver.shared.ChannelConnectionException;
import org.bimserver.shared.LocalDevelopmentResourceFetcher;
import org.bimserver.shared.UsernamePasswordAuthenticationInfo;
import org.bimserver.shared.exceptions.BimServerClientException;
import org.bimserver.shared.exceptions.PluginException;
import org.bimserver.shared.exceptions.ServiceException;
import org.bimserver.webservices.ServiceMap;
import org.bimserver.webservices.authorization.SystemAuthorization;

import java.io.IOException;
import java.net.URL;
import java.nio.charset.StandardCharsets;
import java.nio.file.Path;
import java.nio.file.Paths;
import java.util.concurrent.TimeUnit;


public class GeometryUpdateDatabaseSize {
    private static BimServer bimServer;

    public static void main(String[] args) throws ServiceException, ChannelConnectionException, BimServerClientException, BimserverDatabaseException, DatabaseRestartRequiredException, DatabaseInitException, PluginException, IOException {
        new GeometryUpdateDatabaseSize().start(args[0]);
    }

    private void start(String arg) throws DatabaseInitException, ServiceException, BimServerClientException, PluginException, ChannelConnectionException, DatabaseRestartRequiredException, BimserverDatabaseException, IOException {
        BimServerClientInterface client = startBimServer(arg);

        long poid = client.getServiceInterface().addProject("test" + Math.random(), "ifc4").getOid();
        long deserializerID = client.getServiceInterface().getSuggestedDeserializerForExtension("ifc", poid).getOid();
        long roid = client.checkinSync(poid, "test", deserializerID, false, new URL("http://www.ifcwiki.org/images/e/e3/AC20-FZK-Haus.ifc")).getRoid();
        long dbSize = client.getAdminInterface().getDatabaseInformation().getDatabaseSizeInBytes();
        System.out.println(dbSize);
        int noEntities = client.getLowLevelInterface().count(roid, "[ALL]"); // 44249
        System.out.println(noEntities);
        long geomReportId = client.getServiceInterface().getExtendedDataSchemaByName("GEOMETRY_GENERATION_REPORT_JSON_1_1").getOid();
        SExtendedData data = client.getServiceInterface().getAllExtendedDataOfRevisionAndSchema(roid, geomReportId).get(0);
        byte[] jsonGeometryReport = client.getServiceInterface().getFile(data.getFileId()).getData();
        ObjectMapper objectMapper = new ObjectMapper().enable(SerializationFeature.INDENT_OUTPUT);
        JsonNode jsonGeometryReportRoot = objectMapper.readTree(jsonGeometryReport);
        System.out.println(objectMapper.writeValueAsString(jsonGeometryReportRoot.get("ifcModel")));
        client.disconnect();

        bimServer.stop();

        // {"renderEngine":{"name":"IfcOpenShell","version":{"branch":"v0.6.0","commitsha":"b4ce5be","datetime":1562295697000,"protocolVersion":"IfcOpenShell-0.6.0b0-0","platform":"win64"},"pluginVersion":"0.5.91"},"ifcModel":{"filename":"http://www.ifcwiki.org/images/e/e3/AC20-FZK-Haus.ifc","filesize":2482285,"schema":"IFC4","objects":44259,"triangles":26768,"trianglesIncludingReuse":0},"user":{"name":"Administrator","username":"admin@bimserver.org"},"settings":{"maxObjectsPerFile":1,"reuseGeometry":true,"useMappingOptimization":true,"applyLayersets":true,"calculateQuantities":true},"engineSettings":{},"deserializer":{"name":"org.opensourcebim.ifcplugins:0.0.99"},"system":{"cores":6},"jobs":[{"id":1,"mainType":"IfcBeam","objects":[{"oid":263829,"type":"IfcBeam"},{"oid":198293,"type":"IfcBeam"},{"oid":132757,"type":"IfcBeam"}],"nrObjects":3,"usesMapping":true,"trianglesGenerated":12,"totalTimeNanos":2036966368,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":2,"mainType":"IfcWindow","objects":[{"oid":525692,"type":"IfcWindow"},{"oid":591228,"type":"IfcWindow"},{"oid":394620,"type":"IfcWindow"},{"oid":460156,"type":"IfcWindow"},{"oid":66940,"type":"IfcWindow"}],"nrObjects":5,"usesMapping":true,"trianglesGenerated":204,"totalTimeNanos":2042443399,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":3,"mainType":"IfcWindow","objects":[{"oid":263548,"type":"IfcWindow"},{"oid":329084,"type":"IfcWindow"},{"oid":132476,"type":"IfcWindow"},{"oid":198012,"type":"IfcWindow"}],"nrObjects":4,"usesMapping":true,"trianglesGenerated":204,"totalTimeNanos":1937653813,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":4,"mainType":"IfcDoor","objects":[{"oid":198227,"type":"IfcDoor"},{"oid":132691,"type":"IfcDoor"}],"nrObjects":2,"usesMapping":true,"trianglesGenerated":40,"totalTimeNanos":1965843144,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":5,"mainType":"IfcMember","objects":[{"oid":1770587,"type":"IfcMember"},{"oid":1705051,"type":"IfcMember"},{"oid":1639515,"type":"IfcMember"},{"oid":1573979,"type":"IfcMember"},{"oid":2032731,"type":"IfcMember"},{"oid":1967195,"type":"IfcMember"},{"oid":1901659,"type":"IfcMember"},{"oid":1836123,"type":"IfcMember"},{"oid":1246299,"type":"IfcMember"},{"oid":1180763,"type":"IfcMember"},{"oid":1115227,"type":"IfcMember"},{"oid":1049691,"type":"IfcMember"},{"oid":1508443,"type":"IfcMember"},{"oid":1442907,"type":"IfcMember"},{"oid":1377371,"type":"IfcMember"},{"oid":1311835,"type":"IfcMember"},{"oid":722011,"type":"IfcMember"},{"oid":656475,"type":"IfcMember"},{"oid":590939,"type":"IfcMember"},{"oid":525403,"type":"IfcMember"},{"oid":984155,"type":"IfcMember"},{"oid":918619,"type":"IfcMember"},{"oid":853083,"type":"IfcMember"},{"oid":787547,"type":"IfcMember"},{"oid":197723,"type":"IfcMember"},{"oid":132187,"type":"IfcMember"},{"oid":66651,"type":"IfcMember"},{"oid":459867,"type":"IfcMember"},{"oid":394331,"type":"IfcMember"},{"oid":328795,"type":"IfcMember"},{"oid":263259,"type":"IfcMember"},{"oid":2753627,"type":"IfcMember"},{"oid":2688091,"type":"IfcMember"},{"oid":2622555,"type":"IfcMember"},{"oid":2294875,"type":"IfcMember"},{"oid":2229339,"type":"IfcMember"},{"oid":2163803,"type":"IfcMember"},{"oid":2098267,"type":"IfcMember"},{"oid":2557019,"type":"IfcMember"},{"oid":2491483,"type":"IfcMember"},{"oid":2425947,"type":"IfcMember"},{"oid":2360411,"type":"IfcMember"}],"nrObjects":42,"usesMapping":true,"trianglesGenerated":12,"totalTimeNanos":1852573139,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":6,"mainType":"IfcStair","objects":[{"oid":67035,"type":"IfcStair"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":5228,"totalTimeNanos":4458118095,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":7,"mainType":"IfcDoor","objects":[{"oid":67155,"type":"IfcDoor"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":40,"totalTimeNanos":860437453,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":8,"mainType":"IfcDoor","objects":[{"oid":263763,"type":"IfcDoor"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":948,"totalTimeNanos":1529287057,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":9,"mainType":"IfcDoor","objects":[{"oid":329299,"type":"IfcDoor"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":844,"totalTimeNanos":1530907366,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":10,"mainType":"IfcRailing","objects":[{"oid":66762,"type":"IfcRailing"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":3888,"totalTimeNanos":2580701030,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":11,"mainType":"IfcRailing","objects":[{"oid":132298,"type":"IfcRailing"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":3888,"totalTimeNanos":2655703163,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":12,"mainType":"IfcSpace","objects":[{"oid":67056,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":671738307,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":13,"mainType":"IfcSpace","objects":[{"oid":132592,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":921593411,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":14,"mainType":"IfcSpace","objects":[{"oid":198128,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":887469322,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":15,"mainType":"IfcSpace","objects":[{"oid":263664,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":16,"totalTimeNanos":843486853,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":16,"mainType":"IfcSpace","objects":[{"oid":329200,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":36,"totalTimeNanos":1515249054,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":17,"mainType":"IfcSpace","objects":[{"oid":394736,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":16,"totalTimeNanos":1515282846,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":18,"mainType":"IfcSpace","objects":[{"oid":460272,"type":"IfcSpace"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":16,"totalTimeNanos":1499666859,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":19,"mainType":"IfcOpeningElement","objects":[{"oid":66628,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1327803625,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":20,"mainType":"IfcOpeningElement","objects":[{"oid":132164,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1183149070,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":21,"mainType":"IfcOpeningElement","objects":[{"oid":197700,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1171521219,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":22,"mainType":"IfcOpeningElement","objects":[{"oid":263236,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1349564971,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":23,"mainType":"IfcOpeningElement","objects":[{"oid":328772,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1358990542,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":24,"mainType":"IfcOpeningElement","objects":[{"oid":394308,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1343437019,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":25,"mainType":"IfcOpeningElement","objects":[{"oid":459844,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1240100488,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":26,"mainType":"IfcOpeningElement","objects":[{"oid":525380,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1359010339,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":27,"mainType":"IfcOpeningElement","objects":[{"oid":590916,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1343379675,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":28,"mainType":"IfcOpeningElement","objects":[{"oid":656452,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1463252767,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":29,"mainType":"IfcOpeningElement","objects":[{"oid":721988,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1462754421,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":30,"mainType":"IfcOpeningElement","objects":[{"oid":787524,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1359283064,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":31,"mainType":"IfcOpeningElement","objects":[{"oid":853060,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1359374200,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":32,"mainType":"IfcOpeningElement","objects":[{"oid":918596,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":24,"totalTimeNanos":1384707938,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":33,"mainType":"IfcOpeningElement","objects":[{"oid":984132,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":1361557025,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":34,"mainType":"IfcOpeningElement","objects":[{"oid":1049668,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":1016,"totalTimeNanos":1702425513,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":35,"mainType":"IfcOpeningElement","objects":[{"oid":1115204,"type":"IfcOpeningElement"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":1016,"totalTimeNanos":1702408104,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":36,"mainType":"IfcWindow","objects":[{"oid":656764,"type":"IfcWindow"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":2404,"totalTimeNanos":2405316603,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":37,"mainType":"IfcWindow","objects":[{"oid":722300,"type":"IfcWindow"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":2404,"totalTimeNanos":2389624158,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":38,"mainType":"IfcWallStandardCase","objects":[{"oid":66805,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":1622047725,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":39,"mainType":"IfcWallStandardCase","objects":[{"oid":132341,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":28,"totalTimeNanos":1739952692,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":40,"mainType":"IfcWallStandardCase","objects":[{"oid":197877,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":1265346846,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":41,"mainType":"IfcWallStandardCase","objects":[{"oid":263413,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":44,"totalTimeNanos":1234149005,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":42,"mainType":"IfcWallStandardCase","objects":[{"oid":328949,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":1124714901,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":43,"mainType":"IfcWallStandardCase","objects":[{"oid":394485,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":84,"totalTimeNanos":1842872795,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":44,"mainType":"IfcWallStandardCase","objects":[{"oid":460021,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":84,"totalTimeNanos":1109081848,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":45,"mainType":"IfcWallStandardCase","objects":[{"oid":525557,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":68,"totalTimeNanos":1780923238,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":46,"mainType":"IfcWallStandardCase","objects":[{"oid":591093,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":96,"totalTimeNanos":1405997221,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":47,"mainType":"IfcWallStandardCase","objects":[{"oid":656629,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":788,"totalTimeNanos":2624401558,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":48,"mainType":"IfcWallStandardCase","objects":[{"oid":722165,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":4670858350,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":49,"mainType":"IfcWallStandardCase","objects":[{"oid":787701,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":788,"totalTimeNanos":2499486294,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":50,"mainType":"IfcWallStandardCase","objects":[{"oid":853237,"type":"IfcWallStandardCase"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":4014863689,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":51,"mainType":"IfcBeam","objects":[{"oid":67221,"type":"IfcBeam"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":577898686,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":52,"mainType":"IfcSlab","objects":[{"oid":67276,"type":"IfcSlab"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":546646232,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":53,"mainType":"IfcSlab","objects":[{"oid":132812,"type":"IfcSlab"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":32,"totalTimeNanos":609155917,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":54,"mainType":"IfcSlab","objects":[{"oid":198348,"type":"IfcSlab"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":577970366,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":55,"mainType":"IfcSlab","objects":[{"oid":263884,"type":"IfcSlab"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":12,"totalTimeNanos":577989139,"cpuTimeMs":0,"maxMemoryBytes":0},{"id":56,"mainType":"IfcSite","objects":[{"oid":66485,"type":"IfcSite"}],"nrObjects":1,"usesMapping":false,"trianglesGenerated":48,"totalTimeNanos":593659397,"cpuTimeMs":0,"maxMemoryBytes":0}],"processing":{"start":1580931624604,"stop":1580931640928,"totaltime":16324},"geometry":[{"type":"IfcFacetedBrep","count":7},{"type":"IfcMappedItem","count":56},{"type":"IfcBooleanClippingResult","count":4},{"type":"IfcExtrudedAreaSolid","count":15},{"type":"IfcPolyline","count":13}],"skippedBecauseOfInvalidRepresentationIdentifier":[{"identifier":"FootPrint","skipped":7},{"identifier":"Annotation","skipped":14}],"debugFiles":[]}

    }

    private BimServerClientInterface startBimServer(String home) throws BimServerClientException, ServiceException, ChannelConnectionException, BimserverDatabaseException, DatabaseRestartRequiredException, DatabaseInitException, PluginException {
        Path homePath = Paths.get(home);
        BimServerConfig config = new BimServerConfig();
        config.setHomeDir(homePath);
        config.setStartEmbeddedWebServer(true);
        config.setResourceFetcher(new LocalDevelopmentResourceFetcher(Paths.get("../")));
        config.setPort(7010);
        config.setClassPath(System.getProperty("java.class.path"));
        bimServer = new BimServer(config);
        bimServer.setEmbeddedWebServer(new EmbeddedWebServer(bimServer, null, false));
        bimServer.start();
        if (bimServer.getServerInfo().getServerState().equals(ServerState.NOT_SETUP)) {
            BimServerClientInterface client = bimServer.getBimServerClientFactory().create();
            client.getAdminInterface().setup("http://localhost:7010", "Test Name", "Test Description", "noicon", "Administrator", "admin@localhost", "admin");
            ServiceMap serviceMap = bimServer.getServiceFactory().get(new SystemAuthorization(1, TimeUnit.HOURS), AccessMethod.INTERNAL);
            serviceMap.getSettingsInterface().setCacheOutputFiles(false);
            ((DirectBimServerClientFactory) bimServer.getBimServerClientFactory()).setBaseAddress("http://localhost:7010");
            client.disconnect();
            client = bimServer.getBimServerClientFactory().create(new UsernamePasswordAuthenticationInfo("admin@localhost", "admin"));
            client.getPluginInterface().installPluginBundle("https://repo1.maven.org/maven2/", "org.opensourcebim", "ifcplugins", null, null);
            client.getPluginInterface().installPluginBundle("https://repo1.maven.org/maven2/", "org.opensourcebim", "binaryserializers", null, null);
            client.getPluginInterface().installPluginBundle("https://repo1.maven.org/maven2/", "org.opensourcebim", "ifcopenshellplugin", null, null);
            client.disconnect();
        }
    return new JsonBimServerClientFactory("http://localhost:7010").create(
            new UsernamePasswordAuthenticationInfo("admin@localhost", "admin")
    );
    }
}

